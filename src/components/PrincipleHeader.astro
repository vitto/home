---
import Icon from './Icon.astro';
import Badge from './Badge.astro';
import Button from './Button.astro';

/**
 * PrincipleHeader Component
 *
 * Displays the header section for a principle page with icon, badge, title, and description
 *
 * Props:
 * @param {object} principle - Principle object with icon, color, category, title, description
 * @param {string} sectionName - Name of the section (e.g., "User-Centered Design", "Design Systems", "Human-Centered AI Design")
 * @param {string} sectionPath - Path to the section page (e.g., "/user-centered-design")
 * @param {string} class - Additional CSS classes
 */
interface Props {
  principle: {
    icon: string;
    category: string;
    title: string;
    description: string;
  };
  categoryColors: Record<string, string>;
  sectionName: string;
  sectionPath: string;
  class?: string;
}

const {
  principle,
  categoryColors,
  sectionName,
  sectionPath,
  class: className = 'grid gap-200',
} = Astro.props;

// Get base URL from Astro config and normalize it
// Remove trailing slash if present (except for root)
const rawBaseUrl = import.meta.env.BASE_URL;
const baseUrl = rawBaseUrl === '/' ? '' : rawBaseUrl.replace(/\/$/, '');
const categorySectionUrl = `${baseUrl}${sectionPath}`;
const categoryUrl = `${categorySectionUrl}?category=${encodeURIComponent(principle.category)}`;

// Map color names to CSS classes for icon background

const colorClasses: Record<string, string> = {
  'status-success': 'bg-status-success-05',
  'status-info': 'bg-status-info-05',
  'status-error': 'bg-status-error-05',
  'status-warning': 'bg-status-warning-05',
  'label-amaranth': 'bg-label-amaranth-05',
  'label-orchid': 'bg-label-orchid-05',
  'label-violet': 'bg-label-violet-05',
  'label-blue': 'bg-label-blue-05',
  'label-sky': 'bg-label-sky-05',
  'label-aqua': 'bg-label-aqua-05',
  'label-green': 'bg-label-green-05',
  'label-lime': 'bg-label-lime-05',
  'label-yellow': 'bg-label-yellow-05',
  'label-orange': 'bg-label-orange-05',
};

const categoryColor = (categoryColors[principle.category] as string | undefined) || '';
const categoryColorClass = colorClasses[categoryColor] || '';
---

<div class={className}>
  <div class="grid gap-200">
    <h1 class="text-title-h1">{principle.title}</h1>
    <p class="text-info-paragraph">{principle.description}</p>
  </div>
  <div class="flex items-center justify-start gap-400 mobile:gap-200">
    <a
      class={`inline-flex no-underline items-center gap-400 rounded-full py-300 px-600 text-tone-neutral ${categoryColorClass}`}
      href={categoryUrl}
      title={`Back to ${sectionName} and set category to ${principle.category}`}
    >
      <Icon name={principle.icon} />
      <div class="grid grow gap-200">
        <div class="text-title-h6 text-box-trim-both-cap-alphabetic">{sectionName}</div>
        <span class="text-info-option text-box-trim-both-cap-alphabetic">{principle.category}</span>
      </div>
    </a>
    <Button
      href={categorySectionUrl}
      variant="light"
      class="shrink-0 py-300"
      title={`Back to ${sectionName}`}
    >
      <Icon name="mi/outline/apps" class="text-tone-neutral-04" />
    </Button>
  </div>
</div>
