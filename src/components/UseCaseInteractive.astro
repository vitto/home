---
/**
 * UseCaseInteractive Component
 *
 * Wrapper for interactive use case demonstrations
 * Provides a container with appropriate styling for custom interactive content
 *
 * Props:
 * @param {string} class - Additional CSS classes
 */
interface Props {
  class?: string;
  contentClass?: string;
  label?: string;
  clsHeight?: number;
  toggle?: boolean;
  multiple?: boolean;
  articleId?: string;
}

const {
  class: className = '',
  contentClass = 'justify-center items-center gap-400',
  clsHeight = null,
  label = null,
  toggle = false,
  multiple = false,
  articleId = null,
} = Astro.props;

// Validate that toggle and multiple are mutually exclusive
if (toggle && multiple) {
  throw new Error(
    'UseCaseInteractive: `toggle` and `multiple` props cannot be used together. Please use only one of them.'
  );
}

const initialStyle = clsHeight ? `max-height: ${clsHeight}px; min-height: ${clsHeight}px;` : null;
---

<div
  class={`use-case-interactive bg-tone-neutral-10 dark:bg-tone-neutral-09 p-600 pt-400 grid gap-400 grid-cols-full tablet:rounded-[28px] mobile:-mx-600 group ${className}`}
>
  {
    multiple && (
      <>
        <div
          class="inline-flex justify-self-center items-center justify-center min-h-400"
          data-multiple-indicators
        >
          {/* Indicators will be dynamically generated by JavaScript */}
        </div>
        <template data-multiple-indicator-template>
          <a
            class="size-200 rounded-full focus-bounce relative focus-visible:z-10 cursor-pointer bg-tone-neutral-07"
            tabindex="0"
            data-multiple-index
          />
        </template>
      </>
    )
  }
  {
    toggle ? (
      <div class="inline-flex items-center gap-200 text-tone-neutral-04 justify-self-center min-h-600">
        <mds-text class="cursor-default" typography="option">
          off
        </mds-text>
        <mds-input-switch size="sm" typography="option" data-toggle-switch checked />
        <mds-text class="cursor-default" typography="option">
          on
        </mds-text>
      </div>
    ) : !multiple ? (
      <p
        class={`${label ? 'group-hover:blink' : ''} text-info-option text-center text-tone-neutral-03 justify-self-center`}
      >
        {label || 'Interact with this use case to see how it works'}
      </p>
    ) : null
  }

  <div
    class={`flex flex-col items-center justify-center gap-400 bg-tone-neutral overflow-hidden p-600 tablet:py-1200 rounded-xl shadow-sm-sharp dark:border-solid dark:border-tone-neutral-07 dark:border w-full`}
  >
    <div
      class={`flex flex-col transition-cosmetic w-full relative box-border delay-300 opacity-0 scale-90 ${contentClass}`}
      style={initialStyle}
      data-cls-prevent
      data-toggle-container={toggle ? 'true' : undefined}
      data-multiple-container={multiple ? 'true' : undefined}
      lang="en"
    >
      <slot />
    </div>
  </div>
</div>

<script define:vars={{ articleId, multiple }}>
  if (window.initToggle && articleId && !multiple) {
    window.initToggle(articleId);
  }
  if (window.initMultiple && articleId && multiple) {
    window.initMultiple(articleId);
  }
</script>
